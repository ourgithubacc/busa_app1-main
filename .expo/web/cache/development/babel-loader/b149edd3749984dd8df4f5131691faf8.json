{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { StackActions, useNavigation } from \"@react-navigation/native\";\nimport React, { createContext, useEffect, useMemo, useState } from \"react\";\nimport { Login } from \"../Components/Login\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext();\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isLoading = _useState2[0],\n    setIsLoading = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userToken = _useState4[0],\n    setUserToken = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    userInfo = _useState6[0],\n    setUserInfo = _useState6[1];\n  var login = function () {\n    var _ref2 = _asyncToGenerator(function* (email, password) {\n      var navigation = useNavigation();\n      var _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        isLoading = _useState8[0],\n        setIsLoading = _useState8[1];\n      var _useState9 = useState(null),\n        _useState10 = _slicedToArray(_useState9, 2),\n        userToken = _useState10[0],\n        setUserToken = _useState10[1];\n      var _useState11 = useState(null),\n        _useState12 = _slicedToArray(_useState11, 2),\n        userInfos = _useState12[0],\n        setUserInfo = _useState12[1];\n      yield axios.post(\"https://no-vex-abeg.onrender.com/api/signin\", {\n        email: email,\n        password: password\n      }).then(function (res) {\n        console.log(res);\n        if (res.status === 200) {\n          console.log(res.data);\n          var _userInfo = res.data.user;\n          setUserInfo(_userInfo);\n          var token = res.data.token;\n          setUserToken(token);\n          try {\n            AsyncStorage.setItem(\"userInfo\", JSON.stringify(_userInfo));\n            AsyncStorage.setItem(\"userToken\", token);\n            console.log(_userInfo);\n            console.log(token);\n            navigation.dispatch(StackActions.replace(\"Tab\"));\n          } catch (e) {\n            console.log(\"Async Storage error: \" + e);\n          }\n        } else {\n          console.log(\"Attempt to Login failed\");\n        }\n      }).catch(function (e) {\n        console.log(e);\n      });\n    });\n    return function login(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var logout = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      setIsLoading(true);\n      setUserToken(null);\n      try {\n        yield AsyncStorage.removeItem(\"userToken\");\n        yield AsyncStorage.removeItem(\"userInfo\");\n      } catch (e) {\n        console.log(\"\" + e);\n      }\n      setIsLoading(false);\n    });\n    return function logout() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var isLoggedIn = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      try {\n        setIsLoading(true);\n        var _userToken = yield AsyncStorage.getItem(\"userToken\");\n        var _userInfo2 = yield AsyncStorage.getItem(\"userInfo\");\n        _userInfo2 = JSON.parse(_userInfo2);\n        if (_userInfo2) {\n          setUserToken(_userToken);\n          setUserInfo(_userInfo2);\n        }\n        setIsLoading(false);\n      } catch (e) {\n        console.log(\"isLogged in error: \" + e);\n      }\n    });\n    return function isLoggedIn() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    isLoggedIn();\n  }, []);\n  return _jsx(AuthContext.Provider, {\n    value: {\n      login: login,\n      logout: logout,\n      isLoading: isLoading,\n      userToken: userToken,\n      userInfo: userInfo\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["AsyncStorage","StackActions","useNavigation","React","createContext","useEffect","useMemo","useState","Login","AuthContext","AuthProvider","children","isLoading","setIsLoading","userToken","setUserToken","userInfo","setUserInfo","login","email","password","navigation","userInfos","axios","post","then","res","console","log","status","data","user","token","setItem","JSON","stringify","dispatch","replace","e","catch","logout","removeItem","isLoggedIn","getItem","parse"],"sources":["C:/Users/STEPHEN/Desktop/busa_app1-main/context/AuthContext.js"],"sourcesContent":["import AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { StackActions, useNavigation } from \"@react-navigation/native\";\r\nimport React, {createContext, useEffect, useMemo, useState} from \"react\";\r\nimport {Login} from \"../Components/Login\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\n\r\nexport const AuthProvider =({children})=>{\r\n\r\n    const [isLoading, setIsLoading] = useState(false)\r\n    const  [userToken, setUserToken]= useState(null)\r\n   const [userInfo, setUserInfo] = useState(null)\r\n\r\n\r\n    const login = async (email,password) => {\r\n    const navigation = useNavigation()\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [userToken, setUserToken]= useState(null)\r\n    const [userInfos, setUserInfo] = useState(null)\r\n\r\n    await axios.post(\"https://no-vex-abeg.onrender.com/api/signin\", {\r\n       email, password\r\n   }).then((res)=>{\r\n       console.log(res)\r\n       if (res.status === 200) {\r\n           // also store the users values as an object and pass it round\r\n           console.log(res.data);\r\n           let userInfo = res.data.user\r\n           setUserInfo(userInfo)\r\n           let token = res.data.token\r\n           setUserToken(token)\r\n\r\n           try{\r\n               // stringify the user object\r\n               AsyncStorage.setItem(\"userInfo\", JSON.stringify(userInfo))\r\n               // get the user token\r\n               AsyncStorage.setItem(\"userToken\",token)\r\n               console.log(userInfo)\r\n               console.log(token)\r\n           navigation.dispatch(StackActions.replace(\"Tab\"));\r\n           }catch(e){\r\n               console.log(`Async Storage error: ${e}`)\r\n           }\r\n\r\n\r\n           // let useremail = values.email\r\n           // try{\r\n           // AsyncStorage.setItem(\"email\", useremail)\r\n           // // console.log(useremail)\r\n           // navigation.dispatch(StackActions.replace(\"Tab\"));\r\n           // }catch(e){\r\n           //  console.log(`The error is ${e}`)\r\n           // }\r\n       }else{\r\n        console.log(\"Attempt to Login failed\")\r\n       }\r\n   }).catch((e)=>{\r\n       console.log(e)\r\n   }\r\n   \r\n   )\r\n   \r\n};\r\n\r\n\r\n   \r\n\r\n   const logout = async()=>{\r\n    setIsLoading(true)\r\n    setUserToken(null)\r\n    try{\r\n  await  AsyncStorage.removeItem(\"userToken\")\r\n   await AsyncStorage.removeItem(\"userInfo\")\r\n}catch(e){\r\n    console.log(`${e}`)\r\n}\r\n    setIsLoading(false)\r\n   }\r\n\r\n\r\n\r\n   const isLoggedIn = async ()=>{\r\n    try{\r\n        setIsLoading(true)\r\n        let userToken = await AsyncStorage.getItem(\"userToken\")\r\n        let userInfo = await AsyncStorage.getItem(\"userInfo\")\r\n        userInfo = JSON.parse(userInfo)\r\n        if(userInfo){\r\n            setUserToken(userToken)\r\n            setUserInfo(userInfo)\r\n        }\r\n        setIsLoading(false)\r\n    }catch(e){\r\n        console.log(`isLogged in error: ${e}`)\r\n    }\r\n   }\r\n\r\n   useEffect(()=>{\r\n    isLoggedIn()\r\n   }, [])\r\n\r\n\r\n\r\n    return(\r\n        <AuthContext.Provider value={{login, logout, isLoading, userToken, userInfo}}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}